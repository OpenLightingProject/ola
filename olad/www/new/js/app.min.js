angular.module("olaApp",["ngRoute"]).constant("OLA",{MIN_CHANNEL_NUMBER:1,MAX_CHANNEL_NUMBER:512,MIN_CHANNEL_VALUE:0,MAX_CHANNEL_VALUE:255}).factory("$ola",["$http","$window","OLA",function(a,b,c){"use strict";var d=function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push("d"===c||"remove_ports"===c||"modify_ports"===c||"add_ports"===c?c+"="+a[c]:c+"="+encodeURIComponent(a[c]));return b.join("&")},e=function(a){for(var b=1,d=[],e=0;e<c.MAX_CHANNEL_NUMBER;e++)d[e]=parseInt(a[e],10),d[e]>c.MIN_CHANNEL_VALUE&&(b=e+1);return d.length=b,d.join(",")};return{get:{ItemList:function(){return a.get("/json/universe_plugin_list").then(function(a){return a.data})},ServerInfo:function(){return a.get("/json/server_stats").then(function(a){return a.data})},Ports:function(){return a.get("/json/get_ports").then(function(a){return a.data})},PortsId:function(b){return a({method:"GET",url:"/json/get_ports",params:{id:b}}).then(function(a){return a.data})},InfoPlugin:function(b){return a({method:"GET",url:"/json/plugin_info",params:{id:b}}).then(function(a){return a.data})},Dmx:function(b){return a({method:"GET",url:"/get_dmx",params:{u:b}}).then(function(a){return a.data})},UniverseInfo:function(b){return a({method:"GET",url:"/json/universe_info",params:{id:b}}).then(function(a){return a.data})}},post:{ModifyUniverse:function(b){return a({method:"POST",url:"/modify_universe",data:d(b),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(a){return a.data})},AddUniverse:function(b){return a({method:"POST",url:"/new_universe",data:d(b),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(a){return a.data})},Dmx:function(b,c){var f={u:b,d:e(c)};return a({method:"POST",url:"/set_dmx",data:d(f),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(a){return a.data})}},action:{Shutdown:function(){return a.get("/quit").then(function(a){return a.data})},Reload:function(){return a.get("/reload").then(function(a){return a.data})},ReloadPids:function(){return a.get("/reload_pids").then(function(a){return a.data})}},rdm:{GetSectionInfo:function(b,c,d){return a({method:"GET",url:"/json/rdm/section_info",params:{id:b,uid:c,section:d}}).then(function(a){return a.data})},SetSection:function(b,c,d,e,f){return a({method:"GET",url:"/json/rdm/set_section_info",params:{id:b,uid:c,section:d,hint:e,"int":f}}).then(function(a){return a.data})},GetSupportedPids:function(b,c){return a({method:"GET",url:"/json/rdm/supported_pids",params:{id:b,uid:c}}).then(function(a){return a.data})},GetSupportedSections:function(b,c){return a({method:"GET",url:"/json/rdm/supported_sections",params:{id:b,uid:c}}).then(function(a){return a.data})},UidIdentifyDevice:function(b,c){return a({method:"GET",url:"/json/rdm/uid_identify_device",params:{id:b,uid:c}}).then(function(a){return a.data})},UidInfo:function(b,c){return a({method:"GET",url:"/json/rdm/uid_info",params:{id:b,uid:c}}).then(function(a){return a.data})},UidPersonalities:function(b,c){return a({method:"GET",url:"/json/rdm/uid_personalities",params:{id:b,uid:c}}).then(function(a){return a.data})},Uids:function(b){return a({method:"GET",url:"/json/rdm/uids",params:{id:b}}).then(function(a){return a.data})},RunDiscovery:function(b,c){return a({method:"GET",url:"/rdm/run_discovery",params:{id:b,incremental:c}}).then(function(a){return a.data})}},tabs:function(a,c){b.$("ul#ola-nav-tabs").html('<li id="overview" role="presentation"><a href="/new/#/universe/'+c+'/">Overview</a></li><li id="faders" role="presentation"><a href="/new/#/universe/'+c+'/faders">Faders</a></li><li id="keypad" role="presentation"><a href="/new/#/universe/'+c+'/keypad">Keypad</a></li><li id="rdm" role="presentation"><a href="/new/#/universe/'+c+'/rdm">RDM</a></li><li id="patch" role="presentation"><a href="/new/#/universe/'+c+'/patch">RDM Patcher</a></li><li id="settings"role="presentation"><a href="/new/#/universe/'+c+'/settings">Settings</a></li>'),b.$("ul#ola-nav-tabs > li#"+a).addClass("active")},header:function(a,b){$("div#header-universe").html("<h4>"+a+"</h4><div>(id: "+b+")</div>")},error:{modal:function(a,b){$("#errorModalBody").text("undefined"!=typeof a?a:"There has been an error"),$("#errorModalLabel").text("undefined"!=typeof b?b:"Error"),$("#errorModal").modal("show")}}}}]).controller("menuCtrl",["$scope","$ola","$interval","$location",function(a,b,c,d){"use strict";a.Items={},a.Info={},a.goTo=function(a){d.path(a)};var e=function(){b.get.ItemList().then(function(b){a.Items=b}),b.get.ServerInfo().then(function(b){a.Info=b,document.title=b.instance_name+" - "+b.ip})};e(),c(e,1e4)}]).controller("overviewCtrl",["$scope","$ola","$location",function(a,b,c){"use strict";a.Info={},a.Universes={},b.get.ItemList().then(function(b){a.Universes=b.universes}),b.get.ServerInfo().then(function(b){a.Info=b}),a.Shutdown=function(){b.action.Shutdown().then()},a.goUniverse=function(a){c.path("/universe/"+a)}}]).controller("addUniverseCtrl",["$scope","$ola","$window","$location",function(a,b,c,d){"use strict";a.Ports={},a.addPorts=[],a.Universes=[],a.Class="",a.Data={id:0,name:"",add_ports:""},b.get.ItemList().then(function(b){for(var c in b.universes)b.universes.hasOwnProperty(c)&&(a.Data.id===parseInt(b.universes[c].id,10)&&a.Data.id++,a.Universes.push(parseInt(b.universes[c].id,10)))}),a.Submit=function(){"number"==typeof a.Data.id&&""!==a.Data.add_ports&&-1===a.Universes.indexOf(a.Data.id)?((void 0===a.Data.name||""===a.Data.name)&&(a.Data.name="Universe "+a.Data.id),b.post.AddUniverse(a.Data),d.path("/universe/"+a.Data.id)):-1!==a.Universes.indexOf(a.Data.id)?b.error.modal("Universe ID already exists."):(void 0===a.Data.add_ports||""===a.Data.add_ports)&&b.error.modal("There are no ports selected for the universe. This is required.")},b.get.Ports().then(function(b){a.Ports=b}),a.getDirection=function(a){return a?"Output":"Input"},a.updateId=function(){-1!==a.Universes.indexOf(a.Data.id)?a.Class="has-error":a.Class=""},a.TogglePort=function(){a.Data.add_ports=c.$.grep(a.addPorts,Boolean).join(",")}}]).controller("universeCtrl",["$scope","$ola","$routeParams","$interval","OLA",function(a,b,c,d,e){"use strict";b.tabs("overview",c.id),b.get.UniverseInfo(c.id).then(function(a){b.header(a.name,c.id)}),a.dmx=[],a.Universe=c.id;var f=d(function(){b.get.Dmx(a.Universe).then(function(b){for(var c=0;c<e.MAX_CHANNEL_NUMBER;c++)a.dmx[c]="number"==typeof b.dmx[c]?b.dmx[c]:e.MIN_CHANNEL_VALUE})},100);a.$on("$destroy",function(){d.cancel(f)}),a.getColor=function(a){return a>140?"black":"white"}}]).controller("faderUniverseCtrl",["$scope","$ola","$routeParams","$window","$interval","OLA",function(a,b,c,d,e,f){"use strict";b.tabs("faders",c.id),b.get.UniverseInfo(c.id).then(function(a){b.header(a.name,c.id)}),a.get=[],a.list=[],a.last=0,a.offset=0,a.send=!1,a.OLA=f,a.Universe=c.id;for(var g=0;g<f.MAX_CHANNEL_NUMBER;g++)a.list[g]=g,a.get[g]=f.MIN_CHANNEL_VALUE;a.light=function(b){for(var c=0;c<f.MAX_CHANNEL_NUMBER;c++)a.get[c]=b;a.change()};var h=e(function(){b.get.Dmx(a.Universe).then(function(b){for(var c=0;c<f.MAX_CHANNEL_NUMBER;c++)c<b.dmx.length?a.get[c]=b.dmx[c]:a.get[c]=f.MIN_CHANNEL_VALUE;a.send=!0})},1e3);a.getColor=function(a){return a>140?"black":"white"},a.ceil=function(a){return d.Math.ceil(a)},a.change=function(){b.post.Dmx(a.Universe,a.get)},a.page=function(b){if(1===b){var c=d.Math.ceil(f.MAX_CHANNEL_NUMBER/a.limit);a.offset+1!==c&&a.offset++}else b===f.MIN_CHANNEL_VALUE&&a.offset!==f.MIN_CHANNEL_VALUE&&a.offset--},a.getWidth=function(){var b=d.Math.floor(.99*d.innerWidth/a.limit),c=b-52/a.limit;return c+"px"},a.getLimit=function(){var a=.99*d.innerWidth/66;return d.Math.floor(a)},a.limit=a.getLimit(),a.width={width:a.getWidth()},d.$(d).resize(function(){a.$apply(function(){a.limit=a.getLimit(),a.width={width:a.getWidth()}})}),a.$on("$destroy",function(){e.cancel(h)})}]).controller("keypadUniverseCtrl",["$scope","$ola","$routeParams",function(a,b,c){"use strict";b.tabs("keypad",c.id),a.Universe=c.id,b.get.UniverseInfo(c.id).then(function(a){b.header(a.name,c.id)})}]).controller("rdmUniverseCtrl",["$scope","$ola","$routeParams",function(a,b,c){"use strict";b.tabs("rdm",c.id),a.Universe=c.id,b.get.UniverseInfo(c.id).then(function(a){b.header(a.name,c.id)})}]).controller("patchUniverseCtrl",["$scope","$ola","$routeParams",function(a,b,c){"use strict";b.tabs("patch",c.id),a.Universe=c.id,b.get.UniverseInfo(c.id).then(function(a){b.header(a.name,c.id)})}]).controller("settingUniverseCtrl",["$scope","$ola","$routeParams",function(a,b,c){"use strict";b.tabs("settings",c.id),a.loadData=function(){a.Data={old:{},model:{},Remove:[],Add:[]},a.Data.old.id=a.Data.model.id=c.id,b.get.PortsId(c.id).then(function(b){a.DeactivePorts=b}),b.get.UniverseInfo(c.id).then(function(d){window.console.log(d),b.header(d.name,c.id),a.Data.old.name=a.Data.model.name=d.name,a.Data.old.merge_mode=d.merge_mode,a.Data.model.merge_mode=d.merge_mode,a.ActivePorts=d.output_ports.concat(d.input_ports),a.Data.old.ActivePorts=d.output_ports.concat(d.input_ports);for(var e=0;e<a.ActivePorts.length;++e)a.Data.Remove[e]=""})},a.loadData(),a.Save=function(){var c={};c.id=a.Data.model.id,c.name=a.Data.model.name,c.merge_mode=a.Data.model.merge_mode,c.add_ports=$.grep(a.Data.Add,Boolean).join(","),c.remove_ports=$.grep(a.Data.Remove,Boolean).join(",");var d=[];a.ActivePorts.forEach(function(b,e){if(-1===a.Data.Remove.indexOf(a.ActivePorts[e].id)){var f=a.ActivePorts[e],g=a.Data.old.ActivePorts[e];"static"===f.priority.current_mode&&0<f.priority.value<100&&(c[f.id+"_priority_value"]=f.priority.value,-1===d.indexOf(f.id)&&d.push(f.id)),g.priority.current_mode!==f.priority.current_mode&&(c[f.id+"_priority_mode"]=f.priority.current_mode,-1===d.indexOf(f.id)&&d.push(f.id))}}),c.modify_ports=$.grep(d,Boolean).join(","),b.post.ModifyUniverse(c).then(function(a){window.console.log(a)}),a.loadData()}}]).controller("pluginInfoCtrl",["$scope","$routeParams","$ola","$window",function(a,b,c,d){"use strict";c.get.InfoPlugin(b.id).then(function(b){a.active=b.active,a.enabled=b.enabled,a.name=b.name;var c=document.getElementById("description");c.textContent=b.description,c.innerHTML=c.innerHTML.replace(/\\n/g,"<br />"),d.console.log(b)}),a.stateColor=function(a){return a?{"background-color":"green"}:{"background-color":"red"}}}]).controller("pluginsCtrl",["$scope","$ola","$location",function(a,b,c){"use strict";a.Items={},a.active=[],a.enabled=[],a.getInfo=function(){b.get.ItemList().then(function(b){a.Items=b})},a.getInfo(),a.Reload=function(){b.action.Reload().then(),a.getInfo()},a.go=function(a){c.path("/plugin/"+a)},a.getStyle=function(a){return a?{"background-color":"green"}:{"background-color":"red"}}}]).config(["$routeProvider",function(a){"use strict";a.when("/",{templateUrl:"/new/views/overview.html",controller:"overviewCtrl"}).when("/universes/",{templateUrl:"/new/views/universes.html",controller:"overviewCtrl"}).when("/universe/add",{templateUrl:"/new/views/universe-add.html",controller:"addUniverseCtrl"}).when("/universe/:id",{templateUrl:"/new/views/universe-overview.html",controller:"universeCtrl"}).when("/universe/:id/keypad",{templateUrl:"/new/views/universe-keypad.html",controller:"keypadUniverseCtrl"}).when("/universe/:id/faders",{templateUrl:"/new/views/universe-faders.html",controller:"faderUniverseCtrl"}).when("/universe/:id/rdm",{templateUrl:"/new/views/universe-rdm.html",controller:"rdmUniverseCtrl"}).when("/universe/:id/patch",{templateUrl:"/new/views/universe-patch.html",controller:"patchUniverseCtrl"}).when("/universe/:id/settings",{templateUrl:"/new/views/universe-settings.html",controller:"settingUniverseCtrl"}).when("/plugins",{templateUrl:"/new/views/plugins.html",controller:"pluginsCtrl"}).when("/plugin/:id",{templateUrl:"/new/views/plugin-info.html",controller:"pluginInfoCtrl"}).otherwise({redirectTo:"/"})}]).filter("startFrom",function(){"use strict";return function(a,b){return b=parseInt(b,10),a.slice(b)}});
//# sourceMappingURL=app.min.js.map