var ola=angular.module("olaApp",["ngRoute","hc.marked"]);ola.config(["$locationProvider",function(e){"use strict";e.hashPrefix("")}]),ola.config(["$routeProvider",function(e){"use strict";e.when("/",{templateUrl:"/new/views/overview.html",controller:"overviewCtrl"}).when("/universes/",{templateUrl:"/new/views/universes.html",controller:"overviewCtrl"}).when("/universe/add",{templateUrl:"/new/views/universe-add.html",controller:"addUniverseCtrl"}).when("/universe/:id",{templateUrl:"/new/views/universe-overview.html",controller:"universeCtrl"}).when("/universe/:id/keypad",{templateUrl:"/new/views/universe-keypad.html",controller:"keypadUniverseCtrl"}).when("/universe/:id/faders",{templateUrl:"/new/views/universe-faders.html",controller:"faderUniverseCtrl"}).when("/universe/:id/rdm",{templateUrl:"/new/views/universe-rdm.html",controller:"rdmUniverseCtrl"}).when("/universe/:id/patch",{templateUrl:"/new/views/universe-patch.html",controller:"patchUniverseCtrl"}).when("/universe/:id/settings",{templateUrl:"/new/views/universe-settings.html",controller:"settingUniverseCtrl"}).when("/plugins",{templateUrl:"/new/views/plugins.html",controller:"pluginsCtrl"}).when("/plugin/:id",{templateUrl:"/new/views/plugin-info.html",controller:"pluginInfoCtrl"}).otherwise({redirectTo:"/"})}]),ola.config(["markedProvider",function(e){"use strict";e.setOptions({gfm:!0,tables:!0})}]),ola.controller("menuCtrl",["$scope","$ola","$interval","$location",function(t,e,n,r){"use strict";t.Items={},t.Info={},t.goTo=function(e){r.path(e)};function o(){e.get.ItemList().then(function(e){t.Items=e}),e.get.ServerInfo().then(function(e){t.Info=e,document.title=e.instance_name+" - "+e.ip})}o(),n(o,1e4)}]),ola.controller("patchUniverseCtrl",["$scope","$ola","$routeParams",function(e,t,n){"use strict";e.Universe=n.id}]),ola.controller("rdmUniverseCtrl",["$scope","$ola","$routeParams",function(e,t,n){"use strict";e.Universe=n.id}]),ola.controller("universeCtrl",["$scope","$ola","$routeParams","$interval","OLA",function(n,e,t,r,o){"use strict";n.dmx=[],n.Universe=t.id;var i=r(function(){e.get.Dmx(n.Universe).then(function(e){for(var t=0;t<o.MAX_CHANNEL_NUMBER;t++)n.dmx[t]="number"==typeof e.dmx[t]?e.dmx[t]:o.MIN_CHANNEL_VALUE})},100);n.$on("$destroy",function(){r.cancel(i)}),n.getColor=function(e){return 140<e?"black":"white"}}]),ola.controller("faderUniverseCtrl",["$scope","$ola","$routeParams","$window","$interval","OLA",function(n,e,t,r,o,i){"use strict";n.get=[],n.list=[],n.last=0,n.offset=0,n.send=!1,n.OLA=i,n.Universe=t.id;for(var a=0;a<i.MAX_CHANNEL_NUMBER;a++)n.list[a]=a,n.get[a]=i.MIN_CHANNEL_VALUE;n.light=function(e){for(var t=0;t<i.MAX_CHANNEL_NUMBER;t++)n.get[t]=e;n.change()};var u=o(function(){e.get.Dmx(n.Universe).then(function(e){for(var t=0;t<i.MAX_CHANNEL_NUMBER;t++)t<e.dmx.length?n.get[t]=e.dmx[t]:n.get[t]=i.MIN_CHANNEL_VALUE;n.send=!0})},1e3);n.getColor=function(e){return 140<e?"black":"white"},n.ceil=function(e){return r.Math.ceil(e)},n.change=function(){e.post.Dmx(n.Universe,n.get)},n.page=function(e){var t=n.getPageCount(),e=n.offset+e;t<e+1?e-=t:e<0&&(e+=t),n.offset=e},n.getWidth=function(){return r.Math.floor(.99*r.innerWidth/n.limit)-52/n.limit+"px"},n.getLimit=function(){var e=.99*r.innerWidth/66;return r.Math.floor(e)},n.getPageCount=function(){var e=i.MAX_CHANNEL_NUMBER/n.limit;return r.Math.ceil(e)},n.limit=n.getLimit(),n.width={width:n.getWidth()},r.$(r).resize(function(){n.$apply(function(){n.limit=n.getLimit();var e=n.getPageCount();n.offset+1>e&&(n.offset=e-1),n.width={width:n.getWidth()}})}),n.$on("$destroy",function(){o.cancel(u)})}]),ola.controller("keypadUniverseCtrl",["$scope","$ola","$routeParams","OLA",function(u,s,e,d){"use strict";u.Universe=e.id,t=/^(?:([0-9]{1,3})(?:\s(THRU)\s(?:([0-9]{1,3}))?)?(?:\s(@)\s(?:([0-9]{1,3}|FULL))?)?)/;var t,n={channelValue:function(e){return d.MIN_CHANNEL_VALUE<=e&&e<=d.MAX_CHANNEL_VALUE},channelNumber:function(e){return d.MIN_CHANNEL_NUMBER<=e&&e<=d.MAX_CHANNEL_NUMBER},regexGroups:function(e){if(void 0!==e[1]&&!this.channelNumber(parseInt(e[1],10)))return!1;if(void 0!==e[3]&&!this.channelNumber(parseInt(e[3],10)))return!1;if(void 0!==e[5]&&"FULL"!==e[5]&&!this.channelValue(parseInt(e[5],10)))return!1;return!0}};u.field="",u.input=function(e){e="backspace"===e?u.field.substr(0,u.field.length-1):u.field+e,e=t.exec(e);null===e?u.field="":n.regexGroups(e)&&(u.field=e[0]),u.focusInput=!0},u.keypress=function(e){var t=e.key;if(!(e.altKey||e.ctrlKey||e.metaKey||0===e.which&&"Enter"!==t&&"Backspace"!==t))switch(e.preventDefault(),t){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":u.input(t);break;case"@":case"a":u.input(" @ ");break;case">":case"t":u.input(" THRU ");break;case"f":u.input("FULL");break;case"Backspace":u.input("backspace");break;case"Enter":u.submit()}},u.submit=function(){u.focusInput=!0;var r,o,i,a=[],e=u.field,e=t.exec(e);return!(null===e||!n.regexGroups(e)||(r=parseInt(e[1],10),o=e[3]?parseInt(e[3],10):parseInt(e[1],10),i="FULL"===e[5]?d.MAX_CHANNEL_VALUE:parseInt(e[5],10),!(r<=o&&n.channelValue(i)))||(s.get.Dmx(u.Universe).then(function(e){for(var t=0;t<d.MAX_CHANNEL_NUMBER;t++)t<e.dmx.length?a[t]=e.dmx[t]:a[t]=d.MIN_CHANNEL_VALUE;for(var n=r;n<=o;n++)a[n-1]=i;s.post.Dmx(u.Universe,a),u.field=""}),0))},u.focusInput=!0}]),ola.controller("pluginsCtrl",["$scope","$ola","$location",function(n,r,t){"use strict";n.Items={},n.active=[],n.enabled=[],n.getInfo=function(){r.get.ItemList().then(function(e){n.Items=e})},n.getInfo(),n.Reload=function(){r.action.Reload(),n.getInfo()},n.go=function(e){t.path("/plugin/"+e)},n.changeStatus=function(e,t){r.post.PluginState(e,t),n.getInfo()},n.getStyle=function(e){return e?{"background-color":"green"}:{"background-color":"red"}}}]),ola.controller("addUniverseCtrl",["$scope","$ola","$window","$location",function(n,e,t,r){"use strict";n.Ports={},n.addPorts=[],n.Universes=[],n.Class="",n.Data={id:0,name:"",add_ports:""},e.get.ItemList().then(function(e){for(var t in e.universes)e.universes.hasOwnProperty(t)&&(n.Data.id===parseInt(e.universes[t].id,10)&&n.Data.id++,n.Universes.push(parseInt(e.universes[t].id,10)))}),n.Submit=function(){"number"==typeof n.Data.id&&""!==n.Data.add_ports&&-1===n.Universes.indexOf(n.Data.id)?(void 0!==n.Data.name&&""!==n.Data.name||(n.Data.name="Universe "+n.Data.id),e.post.AddUniverse(n.Data),r.path("/universe/"+n.Data.id)):-1!==n.Universes.indexOf(n.Data.id)?e.error.modal("Universe ID already exists."):void 0!==n.Data.add_ports&&""!==n.Data.add_ports||e.error.modal("There are no ports selected for the universe. This is required.")},e.get.Ports().then(function(e){n.Ports=e}),n.getDirection=function(e){return e?"Output":"Input"},n.updateId=function(){-1!==n.Universes.indexOf(n.Data.id)?n.Class="has-error":n.Class=""},n.TogglePort=function(){n.Data.add_ports=t.$.grep(n.addPorts,Boolean).join(",")}}]),ola.controller("pluginInfoCtrl",["$scope","$routeParams","$ola","$sce","marked",function(t,e,n,r,o){"use strict";n.get.InfoPlugin(e.id).then(function(e){t.active=e.active,t.enabled=e.enabled,t.name=e.name,t.description=r.trustAsHtml(o(e.description.replace(/\\n/g,"\n")))}),t.stateColor=function(e){return e?{"background-color":"green"}:{"background-color":"red"}}}]),ola.controller("settingUniverseCtrl",["$scope","$ola","$routeParams",function(i,e,t){"use strict";i.loadData=function(){i.Data={old:{},model:{},Remove:[],Add:[]},i.Data.old.id=i.Data.model.id=t.id,e.get.PortsId(t.id).then(function(e){i.DeactivePorts=e}),e.get.UniverseInfo(t.id).then(function(e){i.Data.old.name=i.Data.model.name=e.name,i.Data.old.merge_mode=e.merge_mode,i.Data.model.merge_mode=e.merge_mode,i.ActivePorts=e.output_ports.concat(e.input_ports),i.Data.old.ActivePorts=e.output_ports.concat(e.input_ports);for(var t=0;t<i.ActivePorts.length;++t)i.Data.Remove[t]=""})},i.loadData(),i.Save=function(){var r={},o=(r.id=i.Data.model.id,r.name=i.Data.model.name,r.merge_mode=i.Data.model.merge_mode,r.add_ports=$.grep(i.Data.Add,Boolean).join(","),r.remove_ports=$.grep(i.Data.Remove,Boolean).join(","),[]);i.ActivePorts.forEach(function(e,t){var n;-1===i.Data.Remove.indexOf(i.ActivePorts[t].id)&&(n=i.ActivePorts[t],t=i.Data.old.ActivePorts[t],"static"===n.priority.current_mode&&0<n.priority.value<100&&(r[n.id+"_priority_value"]=n.priority.value,-1===o.indexOf(n.id))&&o.push(n.id),t.priority.current_mode!==n.priority.current_mode)&&(r[n.id+"_priority_mode"]=n.priority.current_mode,-1===o.indexOf(n.id))&&o.push(n.id)}),r.modify_ports=$.grep(o,Boolean).join(","),e.post.ModifyUniverse(r),i.loadData()}}]),ola.controller("headerControl",["$scope","$ola","$routeParams","$window",function(t,e,n,r){"use strict";t.header={tab:"",id:n.id,name:""},e.get.UniverseInfo(n.id).then(function(e){t.header.name=e.name});e=r.location.hash;t.header.tab=e.replace(/#\/universe\/[0-9]+\/?/,"")}]),ola.controller("overviewCtrl",["$scope","$ola","$location",function(t,e,n){"use strict";t.Info={},t.Universes={},e.get.ItemList().then(function(e){t.Universes=e.universes}),e.get.ServerInfo().then(function(e){t.Info=e}),t.Shutdown=function(){e.action.Shutdown().then()},t.goUniverse=function(e){n.path("/universe/"+e)}}]),ola.constant("OLA",{MIN_CHANNEL_NUMBER:1,MAX_CHANNEL_NUMBER:512,MIN_CHANNEL_VALUE:0,MAX_CHANNEL_VALUE:255}),ola.directive("autofocus",["$timeout","$parse",function(o,i){"use strict";return{restrict:"A",link:function(e,t,n){var r=i(n.autofocus);e.$watch(r,function(e){!0===e&&o(function(){t[0].focus()})}),t.bind("blur",function(){e.$apply(r.assign(e,!1))})}}}]),ola.factory("$ola",["$http","$window","OLA",function(i,e,a){"use strict";function n(e){var t,n=[];for(t in e)e.hasOwnProperty(t)&&n.push("d"===t||"remove_ports"===t||"modify_ports"===t||"add_ports"===t?t+"="+e[t]:t+"="+encodeURIComponent(e[t]));return n.join("&")}function r(e){for(var t,n=!0,r=[],o=a.MAX_CHANNEL_NUMBER;o>=a.MIN_CHANNEL_NUMBER;o--){t=e[o-1],(t=parseInt(t,10))<a.MIN_CHANNEL_VALUE?t=a.MIN_CHANNEL_VALUE:t>a.MAX_CHANNEL_VALUE&&(t=a.MAX_CHANNEL_VALUE);(t>a.MIN_CHANNEL_VALUE||!n||o===a.MIN_CHANNEL_NUMBER)&&(r[o-1]=t,n=!1)}return r.join(",")}return{get:{ItemList:function(){return i.get("/json/universe_plugin_list").then(function(e){return e.data})},ServerInfo:function(){return i.get("/json/server_stats").then(function(e){return e.data})},Ports:function(){return i.get("/json/get_ports").then(function(e){return e.data})},PortsId:function(e){return i({method:"GET",url:"/json/get_ports",params:{id:e}}).then(function(e){return e.data})},InfoPlugin:function(e){return i({method:"GET",url:"/json/plugin_info",params:{id:e}}).then(function(e){return e.data})},Dmx:function(e){return i({method:"GET",url:"/get_dmx",params:{u:e}}).then(function(e){return e.data})},UniverseInfo:function(e){return i({method:"GET",url:"/json/universe_info",params:{id:e}}).then(function(e){return e.data})}},post:{ModifyUniverse:function(e){return i({method:"POST",url:"/modify_universe",data:n(e),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){return e.data})},AddUniverse:function(e){return i({method:"POST",url:"/new_universe",data:n(e),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){return e.data})},Dmx:function(e,t){e={u:e,d:r(t)};return i({method:"POST",url:"/set_dmx",data:n(e),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){return e.data})},PluginState:function(e,t){return i({method:"POST",url:"/set_plugin_state",data:n({state:t,plugin_id:e}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){return e.data})}},action:{Shutdown:function(){return i.get("/quit").then(function(e){return e.data})},Reload:function(){return i.get("/reload").then(function(e){return e.data})},ReloadPids:function(){return i.get("/reload_pids").then(function(e){return e.data})}},rdm:{GetSectionInfo:function(e,t,n){return i({method:"GET",url:"/json/rdm/section_info",params:{id:e,uid:t,section:n}}).then(function(e){return e.data})},SetSection:function(e,t,n,r,o){return i({method:"GET",url:"/json/rdm/set_section_info",params:{id:e,uid:t,section:n,hint:r,int:o}}).then(function(e){return e.data})},GetSupportedPids:function(e,t){return i({method:"GET",url:"/json/rdm/supported_pids",params:{id:e,uid:t}}).then(function(e){return e.data})},GetSupportedSections:function(e,t){return i({method:"GET",url:"/json/rdm/supported_sections",params:{id:e,uid:t}}).then(function(e){return e.data})},UidIdentifyDevice:function(e,t){return i({method:"GET",url:"/json/rdm/uid_identify_device",params:{id:e,uid:t}}).then(function(e){return e.data})},UidInfo:function(e,t){return i({method:"GET",url:"/json/rdm/uid_info",params:{id:e,uid:t}}).then(function(e){return e.data})},UidPersonalities:function(e,t){return i({method:"GET",url:"/json/rdm/uid_personalities",params:{id:e,uid:t}}).then(function(e){return e.data})},Uids:function(e){return i({method:"GET",url:"/json/rdm/uids",params:{id:e}}).then(function(e){return e.data})},RunDiscovery:function(e,t){return i({method:"GET",url:"/rdm/run_discovery",params:{id:e,incremental:t}}).then(function(e){return e.data})}},error:{modal:function(e,t){void 0!==e?$("#errorModalBody").text(e):$("#errorModalBody").text("There has been an error"),void 0!==t?$("#errorModalLabel").text(t):$("#errorModalLabel").text("Error"),$("#errorModal").modal("show")}}}}]),ola.filter("startFrom",function(){"use strict";return function(e,t){return t=parseInt(t,10),e.slice(t)}});
//# sourceMappingURL=app.min.js.map